<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>spyne - Tame the interwebs</title>

    <link rel="stylesheet" href="css/styles.css" />
    <link rel="stylesheet" href="css/jquery-ui-1.9.1.custom.css" />
    <script src="assets/scale.fix.js"></script>
    <script src="assets/jquery-1.8.2.min.js"></script>
    <script src="assets/jquery-ui-1.9.1.custom.min.js"></script>

    <script src="assets/jquery.snippet.min.js"></script>
    <script type="text/javascript">
$(document).ready(function(){
    var hide_imports = true;

    var rpc_imports = [
         "from spyne.application import Application"
        ,"from spyne.decorator import srpc"
        ,"from spyne.service import ServiceBase"
        ,"from spyne.model.complex import Array"
        ,"from spyne.model.primitive import Integer"
        ,"from spyne.model.primitive import String"
    ].join("\n")

    var prot_imports = {
        HttpRpc: "from spyne.protocol.http import HttpRpc"
        ,XmlDocument: "from spyne.protocol.xml import XmlDocument"
        ,Soap11: "from spyne.protocol.soap import Soap11"
        ,JsonDocument: "from spyne.protocol.json import JsonDocument"
        ,MessagePackDocument: "from spyne.protocol.msgpack import MessagePackDocument"
        ,MessagePackRpc: "from spyne.protocol.msgpack import MessagePackRpc"
        ,Csv: "from spyne.protocol.csv import Csv"
        ,HtmlRowTable: "from spyne.protocol.html import HtmlRowTable"
        ,HtmlColumnTable: "from spyne.protocol.html import HtmlColumnTable"
        ,HtmlMicroFormat: "from spyne.protocol.html import HtmlMicroFormat"
    };

    // TODO: Fill these up.
    var prot_client = {
        HttpRpc: ["$ curl http://localhost:7789/say_hello?name=World&times=4"]
    }

    var prot_response = {
        JsonDocument: ['{',
            ,'    "say_helloResponse": {'
            ,'        "say_helloResult": {'
            ,'            "string": ['
            ,'                "Hello, World",'
            ,'                "Hello, World",'
            ,'                "Hello, World",'
            ,'                "Hello, World"'
            ,'            ]'
            ,'        }'
            ,'    }'
            ,'}']
        ,Soap11: ["<?xml version='1.0' encoding='utf-8'?>",
            ,'<senv:Envelope xmlns:wsa="http://schemas.xmlsoap.org/ws/2003/03/addressing"'
            ,'xmlns:tns="spyne.examples.hello"'
            ,'xmlns:plink="http://schemas.xmlsoap.org/ws/2003/05/partner-link/"'
            ,'xmlns:xop="http://www.w3.org/2004/08/xop/include"'
            ,'xmlns:senc="http://schemas.xmlsoap.org/soap/encoding/"'
            ,'xmlns:s12env="http://www.w3.org/2003/05/soap-envelope/"'
            ,'xmlns:s12enc="http://www.w3.org/2003/05/soap-encoding/"'
            ,'xmlns:xs="http://www.w3.org/2001/XMLSchema"'
            ,'xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/"'
            ,'xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"'
            ,'xmlns:senv="http://schemas.xmlsoap.org/soap/envelope/"'
            ,'xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/">'
            ,'  <senv:Body>'
            ,'    <tns:say_helloResponse>'
            ,'      <tns:say_helloResult>'
            ,'        <tns:string>Hello, World</tns:string>'
            ,'        <tns:string>Hello, World</tns:string>'
            ,'        <tns:string>Hello, World</tns:string>'
            ,'        <tns:string>Hello, World</tns:string>'
            ,'      </tns:say_helloResult>'
            ,'    </tns:say_helloResponse>'
            ,'  </senv:Body>'
            ,'</senv:Envelope>'
        ]
    }

    var tpt_imports = {
        WsgiApplication: ["from spyne.server.wsgi import WsgiApplication"]
        ,TwistedWebResource: [
            "from spyne.server.twisted import TwistedWebResource"
            ,""
            ,"from twisted.internet import reactor"
            ,"from twisted.web.server import Site"
        ]
        ,DjangoApplication: [
            "from spyne.server.django import DjangoApplication"
            ,""
            ,"from django.views.decorators.csrf import csrf_exempt"
        ]
        ,PyramidApplication: [
            "from spyne.server.pyramid import PyramidApplication"
            ,""
            ,"from pyramid.config import Configurator"
            ,"from pyramid.view import view_config"
        ]
        ,ZeroMQServer: ["from spyne.server.zeromq import ZeroMQServer"]
    }

    var tpt_example = {
        WsgiApplication: ["helloworld_http.py"]
        ,TwistedWebResource: ["twisted"]
        ,DjangoApplication: ["django"]
        ,PyramidApplication: ["pyramid"]
        ,ZeroMQServer: ["zeromq.py"]
    }

    var tpt_code = {
        WsgiApplication: [
            "if __name__=='__main__':"
            ,"    # You can use any Wsgi server. Here, we chose"
            ,"    # Python's built-in wsgi server but you're not"
            ,"    # supposed to use it in production."
            ,"    from wsgiref.simple_server import make_server"
            ,""
            ,"    wsgi_app = WsgiApplication(application)"
            ,"    server = make_server('0.0.0.0', 7789, wsgi_app)"
            ,"    server.serve_forever()"
        ]
        ,ZeroMQServer: [
            "if __name__=='__main__':"
            ,"    wsgi_app = ZeroMQServer(application,"
            ,"                           'tcp://0.0.0.0:5555')"
            ,"    server.serve_forever()"
        ]
        ,TwistedWebResource: [
            "if __name__=='__main__':"
            ,"    resource = TwistedWebResource(application)"
            ,"    site = Site(resource)"
            ,""
            ,"    reactor.listenTCP(7789, site, interface='0.0.0.0')"
        ]
        ,DjangoApplication: [
            "# This module resides in a package in your Django"
            ,"# project."
            ,""
            ,"hello_app = csrf_exempt(DjangoApplication(application))"
            ,""
            ,"# hello_app here has to be put in a package that is"
            ,"# listed in the INSTALLED_APPS list in your settings.py"
            ,"# and referenced in the url.py under an appropriate"
            ,"# regexp entry."
        ]
        ,PyramidApplication: [
            "if __name__ == '__main__':"
            ,"    app = PyramidApplication(application)"
            ,"    pyramid_app = view_config(route_name='home')(application)"
            ,"    settings = {}"
            ,"    settings['debug_all'] = True"
            ,"    config = Configurator(settings=settings)"
            ,"    config.add_route('home', '/')"
            ,"    config.scan()"
            ,""
            ,"    # You can use any Wsgi server. Here, we chose"
            ,"    # Python's built-in wsgi server but you're not"
            ,"    # supposed to use it in production."
            ,"    from wsgiref.simple_server import make_server"
            ,""
            ,"    wsgi_app = config.make_wsgi_app()"
            ,"    server = make_server('0.0.0.0', 7789, wsgi_app)"
            ,"    server.serve_forever()"
        ]
    }

    function setup_import_toggle(div) {
        var ti = div.find("#toggle_imports");
        ti.click(function(e) {
            if (hide_imports) {
                hide_imports = false;
                regen_code_rpc();
                regen_code_db();
                regen_code_aux();
            }
            else {
                hide_imports = true;
                regen_code_rpc();
                regen_code_db();
                regen_code_aux();
            }
        });
    }


    function is_supported(transport, inprot, outprot) {
        if (transport == 'ZeroMQServer' && (inprot == 'HttpRpc' || outprot == 'HttpRpc')) {
            return false;
        }
        return true;
    }

    function regen_code_rpc() {
        var retval = [];

        var version = $("span#version").html();
        var inprot = $('input[name=inprot]:checked').val();
        var outprot = $('input[name=outprot]:checked').val();
        var tpt = $('input[name=tpt]:checked').val();
        var validation = $('input[name=validation]:checked').val();

        // validation
        if (validation == "true") {
            if (inprot == "Soap11") {
                validation = 'validator="lxml"';
            }
            else {
                validation = 'validator="soft"';
            }
        }

        // imports
        if (! hide_imports) {
            retval.push(rpc_imports);
            retval.push("")

            // protocol imports
            retval.push(prot_imports[inprot]);
            if (inprot != outprot) {
                retval.push(prot_imports[outprot]);
            }
            retval.push("");

            // transport imports
            retval = retval.concat(tpt_imports[tpt]);
            retval.push("");
        }

        // user code
        retval = retval.concat([
            ,"class HelloWorldService(ServiceBase:"
            ,"    @srpc(String, Integer, _returns=Array(String)"
            ,"    def say_hello(name, times:"
            ,"        for i in range(times:"
            ,"            yield 'Hello, %s' % name"
            ,""
            ,""
            ,"application = Application([HelloWorldService],"
            ,"    tns='spyne.examples.hello',"
            ,"    in_protocol="+ inprot +"(" + validation + "),"
            ,"    out_protocol="+ outprot +"()"
            ,")"
            ,""
        ]);

        // transport
        if (tpt_code[tpt]) {
            retval = retval.concat(tpt_code[tpt]);
        }
        else {
            retval.push("# Please write an example for this transport and ");
            retval.push("# send a pull request ");
        }

        var div = $("div#code_rpc");
        div.html([
            '<div>'
            ,  '<a id="toggle_imports">'+(hide_imports ? "Show Imports": "Hide Imports")+'</a>'
            ,  ' | '
            ,  '<span class="code_link"></span>'
            ,'</div>'
            ,'<pre id="code"/>'
            ,'Client Code: <pre id="client" />'
            ,'Response Document: <pre id="response" />'
        ].join(''));

        setup_import_toggle(div);

        var example_url = tpt_example[tpt];
        if (! is_supported(tpt, inprot, outprot)) {
            $("span.code_link").html("<br/><strong>Unsupported Protocol/Transport Combination.</strong>");
            return
        }

        $("span.code_link").html(
        "<a target=\"_blank\" href=\"https://github.com/arskom/spyne/tree/spyne-" + version +
            "/examples/"+example_url+"\">A "+tpt+" Example</a>"
        );

        div.children("pre#code").text(retval.join("\n"));
        div.children("pre#code").snippet("python", {
            style:"whitengrey"
            ,clipboard:"assets/ZeroClipboard.swf"
        });

        if (prot_client[inprot]) {
            div.children("pre#client").text(prot_client[inprot].join("\n"));
        }
        else {
            div.children("pre#client").text("Add this client code and send a pull request!");
        }

        if (prot_response[outprot]) {
            div.children("pre#response").text(prot_response[outprot].join("\n"));
        }
        else{
            div.children("pre#response").text("Add this server response document and send a pull request!");
        }
    }

    var db_imports = [

    ].join('\n');

    function regen_code_db() {
        var code = [];
        var sql = [];

        var version = $("span#version").html();
        var ser = $('input[name=ser]:checked').val();

        // imports
        if (! hide_imports) {
            code.push(db_imports);
            code.push("")
        }

        // user code
        code = code.concat([

        ]);

        var div = $("div#code_db");
        div.html([
            '<div>'
            ,  '<a id="toggle_imports">'+(hide_imports ? "Show Imports": "Hide Imports")+'</a>'
            ,'</div>'
            ,'<pre id="code"/>'
            ,'Resulting SQL: <pre id="sql" />'
        ].join(''));

        setup_import_toggle(div);

        div.children("pre#code").text(code.join("\n"));
        div.children("pre#code").snippet("python", {
             style:"whitengrey"
            ,clipboard:"assets/ZeroClipboard.swf"
        });

        div.children("pre#sql").text(sql.join("\n"));
        div.children("pre#sql").snippet("sql", {
             style:"whitengrey"
            ,clipboard:"assets/ZeroClipboard.swf"
        });
    }

    regen_code_rpc();
    regen_code_db();

    $("input.param_rpc").click(function(e) {
        regen_code_rpc();
    });
    $("input.param_db").click(function(e) {
        regen_code_db();
    });
});

$(function() {
    $( "#tabs" ).tabs();
});
    </script>

    <!--<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"> -->
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>

<body>
<div class="wrapper">
<header>
    <div class="header_title">
        <h1 class="header">spyne</h1>
        <small>Tame the interwebs.</small>

        <p class="header"><span style="font-weight: bold">Latest release:</span> <br/>
                Spyne <span id="version">2.9.1</span> <br />
                Oct. 29th, 2012 <br />
                <a href="http://travis-ci.org/arskom/spyne">
                    <img src="https://secure.travis-ci.org/arskom/spyne.png">
                </a>
        </p>
    </div>
    <ul>
        <li class="download"><a class="buttons" href="https://github.com/arskom/spyne/tarball/spyne-2.9.1">Download</a></li>
        <li class="download"><a class="docs" href="docs/index.html">Docs</a></li>
        <li class="buttons"><a class="blog" href="blog/index.html">Blog</a></li>
        <li><a class="buttons github" href="https://github.com/arskom/spyne">GitHub</a></li>
    </ul>
    <div class="clear"></div>
</header>

<section class="what_is">
    <h1>What is Spyne?</h1>

    <p class="text">Spyne is a Python RPC toolkit that makes it easy to expose online services
        that have a well-defined API using multiple protocols and transports.</p>

    <p>It integrates with popular Python web frameworks as well as libraries like
        <a href="https://github.com/arskom/spyne/blob/spyne-2.9.1/examples/user_manager/server_sqlalchemy.py">SQLAlchemy</a>
        to keep your code as
        <a href="http://c2.com/cgi/wiki?DontRepeatYourself">DRY</a> as possible.</p>

    <p>See the <a href="docs/index.html">documentation</a> for more information.
        For a quick introduction, you can have a look at the
        <a href="http://www.youtube.com/watch?v=N4zdWLuSbV0#t=21m58">lightning talk</a>
        and the <a href="slides/2012-03_pycon-2012.pdf">slides</a> from Pycon 2012
        (from back when the project was called Rpclib).
    </p>

    <h1>Getting Started</h1>

    <div id="tabs">
        <ul>
            <li><a href="#tabs-1">RPC</a></li>
            <li><a href="#tabs-2">DB</a></li>
            <!--
            <li><a href="#tabs-3">Aux</a></li>
            -->
        </ul>
        <div id="tabs-1">
            <div id="parameters">
                <form action="#" method="foo">
                    <fieldset>
                        <legend>Input Protocol</legend>
                        <label><input class="param_rpc" type="radio" name="inprot" value="HttpRpc" checked /> HttpRpc</label> <br/>
                        <label><input class="param_rpc" type="radio" name="inprot" value="JsonDocument" /> Json Document</label>  <br/>
                        <label><input class="param_rpc" type="radio" name="inprot" value="Soap11" /> Soap 1.1</label>  <br/>
                        <label><input class="param_rpc" type="radio" name="inprot" value="XmlDocument" /> Xml Document</label>  <br/>
                        <label><input class="param_rpc" type="radio" name="inprot" value="MessagePackDocument"/> MessagePack Document</label>  <br/>
                        <label><input class="param_rpc" type="radio" name="inprot" value="MessagePackRpc" /> MessagePack RPC</label>  <br/>
                    </fieldset>

                    <fieldset>
                        <legend>Output Protocol</legend>
                        <label><input class="param_rpc" type="radio" name="outprot" value="JsonDocument" checked/> Json Document</label>  <br/>
                        <label><input class="param_rpc" type="radio" name="outprot" value="Soap11" /> Soap 1.1</label>  <br/>
                        <label><input class="param_rpc" type="radio" name="outprot" value="XmlDocument" /> Xml Document</label>  <br/>
                        <label><input class="param_rpc" type="radio" name="outprot" value="MessagePackDocument" /> MessagePack Document</label>  <br/>
                        <label><input class="param_rpc" type="radio" name="outprot" value="MessagePackRpc" /> MessagePack RPC</label>  <br/>
                        <label><input class="param_rpc" type="radio" name="outprot" value="Csv" />Comma Separated Values</label>  <br/>
                        <label><input class="param_rpc" type="radio" name="outprot" value="HtmlRowTable" />Html Row Table</label>  <br/>
                        <label><input class="param_rpc" type="radio" name="outprot" value="HtmlColumnTable" />Html Column Table</label>  <br/>
                        <label><input class="param_rpc" type="radio" name="outprot" value="HtmlMicroFormat" />Html MicroFormat</label>  <br/>
                    </fieldset>

                    <fieldset>
                        <legend>Transport</legend>
                        <label><input class="param_rpc" type="radio" name="tpt" value="WsgiApplication" checked /> Http (WSGI)</label> <br/>
                        <label><input class="param_rpc" type="radio" name="tpt" value="TwistedWebResource" /> Http (Twisted)</label>  <br/>
                        <label><input class="param_rpc" type="radio" name="tpt" value="DjangoApplication" /> Http (Django)</label> <br/>
                        <label><input class="param_rpc" type="radio" name="tpt" value="PyramidApplication" /> Http (Pyramid)</label> <br/>
                        <label><input class="param_rpc" type="radio" name="tpt" value="ZeroMQServer" /> ZeroMQ (REQ/REP)</label> <br/>
                    </fieldset>
                    <fieldset>
                        <legend>Validation:</legend>
                        <label><input class="param_rpc" type="radio" name="validation" value="true" checked /> Enabled</label> <br/>
                        <label><input class="param_rpc" type="radio" name="validation" value="" /> Disabled</label> <br/>
                    </fieldset>
                </form>
            </div>

            <div class="code" id="code_rpc"></div>
            <div class="clear"></div>
        </div>
        <div id="tabs-2">
            <div id="parameters">
                <form action="#" method="foo">
                    <fieldset>
                        <legend>Serialization</legend>
                        <label><input class="param_db" type="radio" name="ser" value="None" checked>None</label>  <br/>
                        <label><input class="param_db" type="radio" name="ser" value="Json">Json</label>  <br/>
                        <label><input class="param_db" type="radio" name="ser" value="Xml">Xml</label>  <br/>
                        <label><input class="param_db" type="radio" name="ser" value="SqlOtm">SQL Table (One-to-many)</label>  <br/>
                        <label><input class="param_db" type="radio" name="ser" value="SqlMtm">SQL Table (Many-to-many)</label>  <br/>
                    </fieldset>
                </form>
            </div>

            <div class="code" id="code_db"></div>
            <div class="clear"></div>
        </div>

        <!--
        <div id="tabs-3">
            <div id="parameters">
                <form action="#" method="foo">
                    <fieldset>
                        <legend>Database</legend>
                        <label><input class="param_aux" type="radio" name="db" value="auxproc" checked>None</label> <br/>
                        <label><input class="param_aux" type="radio" name="db" value="auxproc" checked>Sync</label> <br/>
                        <label><input class="param_aux" type="radio" name="db" value="auxproc" checked>Async (Thread)</label> <br/>
                    </fieldset>
                </form>
            </div>

            <div class="code" id="code_aux"></div>
            <div class="clear"></div>
        </div>
        -->
    </div>
</section>
</div>

<footer style="align: center">
    <p>&copy; All content on this web site copyright
        <a href="http://arskom.com.tr">Arskom Ltd.</a></p>

    <p><small>Hosted on
    <a href="https://pages.github.com">GitHub Pages</a>
    using a variation of the Dinky theme. Please use the
    <a href="http://github.com/spyne/spyne.github.com/issues">issue tracker</a>
    at Github for ideas on improving this web site.</small></p>
</footer>

<!--[if !IE]><script>fixScale(document);</script><![endif]-->
</body>
</html>
